{% extends "base.html" %}

{% block content %}
    <div class="container mx-auto text-white">
        <h1 class="mt-3 text-center ">Welcome to PandaMeet Account Info</h1>
        <h4 class="mt-2 text-center ">Here you can add or review details about your account, such as username, birth date, country, email and your hobbies.</h4>

        <div class="row">
            <div class="col-md-6 col-lg-6 col-sm-12 mx-auto">
                <div class="card-body bg-dark mt-5">
                    <div class="card-title h5">Change Username</div>
                    <p class="mt-2 h6"><strong>Your username: @{{ current_user.USERNAME }}</strong></p>
                    <div class="col-12">
                        <form method="POST">
                            {{ userChangeForm.csrf_token }}
                            {{ userChangeForm.newUsername(class="form-control mt-3", id="newUsername", required="required", type="text", placeholder="Insert new username") }}
                            {{ userChangeForm.submit(class="btn btn-primary mt-3", type="submit") }}
                        </form>
                    </div>
                    {% if userChangeForm.errors %}
                    <div class="alert mt-2 alert-danger">
                    {% for field, errors in userChangeForm.errors.items() %}
                        {{ ', '.join(errors) }}
                    {% endfor %}
                    </div>
                    {% endif %}
                    {% with messages = get_flashed_messages(with_categories=true) %}
                       {% if messages %}
                          {% for category, message in messages %}
                              {% if "username-alert" in category %}
                              <div class="alert mt-2  {{ category }}">{{ message }}</div>
                              {% endif %}
                          {% endfor %}
                       {% endif %}
                    {% endwith %}
                </div>
            </div>

            <div class="col-md-6 col-lg-6 col-sm-12 mx-auto">
                <div class="card-body bg-dark mt-5">
                    <div class="card-title h5">Change Email</div>
                    <p class="h6"><strong>Your email: {{ current_user.EMAIL }}</strong></p>
                    <div class="col-12">
                        <form method="post">
                            {{ emailForm.csrf_token }}
                            {{ emailForm.newEmail(class="form-control mt-3", id="newEmail", required="required", type="email", placeholder="Insert new email") }}
                            {{ emailForm.submitEmail(class="btn btn-primary mt-3", type="submit") }}
                        </form>
                    </div>
                    {% if emailForm.errors %}
                    <div class="alert mt-2 alert-danger">
                    {% for field, errors in emailForm.errors.items() %}
                        {{ ', '.join(errors) }}
                    {% endfor %}
                    </div>
                    {% endif %}
                    {% with messages = get_flashed_messages(with_categories=true) %}
                       {% if messages %}
                          {% for category, message in messages %}
                              {% if "email-alert" in category %}
                              <div class="alert mt-2  {{ category }}">{{ message }}</div>
                              {% endif %}
                          {% endfor %}
                       {% endif %}
                    {% endwith %}
                </div>
            </div>

            <div class="col-md-6 col-lg-6 col-sm-12 mx-auto">
                <div class="card-body bg-dark mt-5">
                    <div class="card-title h5">Change your birthdate</div>
                    <p class="h6"><strong>Your birthday: {{ current_user.DATA_NASCITA }}</strong></p>
                    <div class="col-12">
                        <form method="post">
                            {{ dateForm.csrf_token }}
                            {{ dateForm.dataNascita(class="form-control mt-3", id="newBirthdate", required="required", type="date", placeholder="Insert new birthdate") }}
                            {{ dateForm.submitData(class="btn btn-primary mt-3", type="submit") }}
                        </form>
                    </div>
                    {% if dateForm.errors %}
                    <div class="alert mt-2 alert-danger">
                    {% for field, errors in dateForm.errors.items() %}
                        {{ ', '.join(errors) }}
                    {% endfor %}
                    </div>
                    {% endif %}
                    {% with messages = get_flashed_messages(with_categories=true) %}
                       {% if messages %}
                          {% for category, message in messages %}
                              {% if "date-alert" in category %}
                              <div class="alert mt-2  {{ category }}">{{ message }}</div>
                              {% endif %}
                          {% endfor %}
                       {% endif %}
                    {% endwith %}
                </div>
            </div>

            <div class="col-md-6 col-lg-6 col-sm-12 mx-auto">
                <div class="card-body bg-dark mt-5">
                    <div class="card-title h5">Change your country</div>
                    <p class="h6"><strong>Your country: {{ userCountry.NOME_PAESE }}</strong></p>
                    <div class="col-12">
                        <form method="post">
                            {{ countryForm.csrf_token }}
                            {{ countryForm.paese(class="form-control mt-3", id="newCountry", required="required", type="form-select") }}
                            {{ countryForm.submitCountry(class="btn btn-primary mt-3", type="submit") }}
                        </form>
                    </div>
                    {% if countryForm.errors %}
                    <div class="alert mt-2 alert-danger">
                    {% for field, errors in countryForm.errors.items() %}
                        {{ ', '.join(errors) }}
                    {% endfor %}
                    </div>
                    {% endif %}
                    {% with messages = get_flashed_messages(with_categories=true) %}
                       {% if messages %}
                          {% for category, message in messages %}
                              {% if "country-alert" in category %}
                              <div class="alert mt-2  {{ category }}">{{ message }}</div>
                              {% endif %}
                          {% endfor %}
                       {% endif %}
                    {% endwith %}
                </div>
            </div>

            <div class="col-md-12 col-lg-12 col-sm-12 mx-auto">
                <div class="card-body bg-dark mt-5">
                    <div class="card-title h5">Set your hobbies</div>
                    <p class="h6"><strong>Current hobbies:
                        {% for Hobby in usersHobbies %}
                            {{ Hobby.NOME_HOBBY }}
                        {% endfor %}
                    </strong></p>
                    <div class="col-12">
                        <form method="post">
                            {{ hobbyForm.csrf_token }}
                            {{ hobbyForm.hobby(class="form-control mt-3", id="newHobby", required="required", type="form-select") }}
                            {{ hobbyForm.submitHobby(class="btn btn-primary mt-3", type="submit") }}
                        </form>
                    </div>
                    {% if hobbyForm.errors %}
                    <div class="alert mt-2 alert-danger">
                    {% for field, errors in hobbyForm.errors.items() %}
                        {{ ', '.join(errors) }}
                    {% endfor %}
                    </div>
                    {% endif %}
                    {% with messages = get_flashed_messages(with_categories=true) %}
                       {% if messages %}
                          {% for category, message in messages %}
                              {% if "hobby-alert" in category %}
                              <div class="alert mt-2  {{ category }}">{{ message }}</div>
                              {% endif %}
                          {% endfor %}
                       {% endif %}
                    {% endwith %}
                </div>
            </div>
        </div>
    </div>


{% endblock %}